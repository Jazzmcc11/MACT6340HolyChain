<%- include("header") %>

<header class="hero d-flex align-items-center justify-content-center text-center text-white bg-dark py-5">
  <div class="container">
    <h1 class="fw-bold mb-3">Let’s Connect</h1>
    <p class="lead mb-0">Questions, collaborations, or feedback — I’d love to hear from you.</p>
  </div>
</header>

<section id="contact" class="py-5">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-md-8 col-lg-6">
        <form id="contactForm" method="POST" action="/mail" class="p-4 bg-light text-dark rounded shadow">
          <div class="row mb-3">
            <div class="col">
              <label for="firstName" class="form-label fw-semibold">First Name</label>
              <input type="text" id="firstName" name="firstName" class="form-control" placeholder="First name" required />
            </div>
            <div class="col">
              <label for="lastName" class="form-label fw-semibold">Last Name</label>
              <input type="text" id="lastName" name="lastName" class="form-control" placeholder="Last name" required />
            </div>
          </div>

          <div class="mb-3">
            <label for="email" class="form-label fw-semibold">Email Address</label>
            <input type="email" id="email" name="email" class="form-control" placeholder="you@example.com" required />
          </div>

          <div class="mb-3">
            <label for="subject" class="form-label fw-semibold">Subject</label>
            <input type="text" id="subject" name="sub" class="form-control" placeholder="Enter your subject" required />
          </div>

          <div class="mb-3">
            <label for="message" class="form-label fw-semibold">Message</label>
            <textarea id="message" name="txt" class="form-control" rows="6" placeholder="Type your message..." required></textarea>
          </div>

          <button type="submit" class="btn btn-primary w-100 fw-semibold">Send Message</button>
        </form>

        <div id="feedback" class="text-center mt-3 fw-semibold"></div>
      </div>
    </div>
  </div>
</section>

<script>
  const form = document.querySelector("#contactForm");
  const feedback = document.querySelector("#feedback");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const sub = document.querySelector("#subject").value.trim();
    const txt = `
    Name: ${document.querySelector("#firstName").value} ${document.querySelector("#lastName").value}
    Email: ${document.querySelector("#email").value}
    Message:
    ${document.querySelector("#message").value}
    `;

    feedback.textContent = "⏳ Sending...";
    feedback.className = "text-warning";

    try {
      const response = await fetch("/mail", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ sub, txt }),
      });

      const data = await response.json();
      if (data.result === "success") {
        feedback.textContent = "✅ Message sent!";
        feedback.className = "text-success";
        form.reset();
      } else {
        feedback.textContent = "❌ Message failed to send.";
        feedback.className = "text-danger";
      }
    } catch (error) {
      feedback.textContent = "⚠️ Could not reach the server.";
      feedback.className = "text-danger";
    }
  });
</script>

<%- include("footer") %>
